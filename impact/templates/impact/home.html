{% extends "impact/base.html" %}

{% load static %}

{% block title %}Fighting Fast Fashion{% endblock %}

{% block content %}

<section class="hero hero-video">
    <!-- Background video -->
    <div class="hero-video-bg">
        <video
            class="hero-video-tag"
            autoplay
            muted
            loop
            playsinline
            poster="{% static 'impact/imgs/clothes-on-rack2.jpg' %}">
            <source src="{% static 'impact/videos/beach-background.mp4' %}" type="video/mp4">
            <!-- Fallback text -->
            Your browser does not support the video tag.
        </video>
    </div>

    <!-- Overlay with text and card -->
    <div class="hero-overlay">
        <div class="hero-inner hero-overlay-inner">
            <div class="hero-text">
                <p class="hero-tagline">Fast fashion's hidden environmental cost</p>

                <h1 class="hero-title">
                    A clear, data-driven look at how fast fashion impacts water,
                    waste, and the planet.
                </h1>
            </div>
            
            <div class="hero-buttons">
                <a href="#problem" class="btn pill">
                    Explore the data
                </a>
                <a href="#solutions" class="btn pill">
                    What you can do
                </a>
            </div>
        </div>
    </div>
</section>

<!-- STRIP SECTION -->
<section class="strip">
    <div class="strip-inner">
        <h2 class="strip-title">A global industry, a global footprint</h2>
        <p class="strip-text">
            Cotton, polyester, viscose: fast fashion relies on materials with heavy resource demands.
            From water use to textile waste, this overview highlights the scale of the issue.
        </p>
    </div>
</section>

<section class="live-water-section">
    <div class="live-water-inner">
        <h2 class="live-water-title">Live Water Use ¬∑ Fashion Industry</h2>
        <p class="live-water-sub">Updated every second</p>

        <div class="live-water-grid">
            <!-- Card 1: liters -->
            <article class="live-water-card">
                <p class="live-water-label">Liters used this year</p>
                <p class="live-water-value">
                    <span id="waterYearLitersDisplay">0</span>
                </p>
                <p class="live-water-note">Total water flowing through the fashion and textile system.</p>
            </article>

            <!-- Card 2: bathtubs -->
            <article class="live-water-card">
                <p class="live-water-label">Bathtubs of water</p>
                <p class="live-water-value">
                    <span id="waterYearBathtubsDisplay">0</span>
                </p>
                <p class="live-water-note">Assuming about 150 liters per full bathtub.</p>
            </article>

            <!-- Card 3: 1-L bottles -->
            <article class="live-water-card">
                <p class="live-water-label">1-L bottles</p>
                <p class="live-water-value">
                    <span id="waterYearBottlesDisplay">0.0</span> B
                </p>
                <div class="live-water-bottle-bar">
                    <div class="live-water-bottle-track">
                        <div class="live-water-bottle-fill">
                            <div class="live-water-bottle-icons">
                                <div class="live-bottle"></div>
                                <div class="live-bottle"></div>
                                <div class="live-bottle"></div>
                                <div class="live-bottle"></div>
                                <div class="live-bottle"></div>
                                <div class="live-bottle"></div>
                                <div class="live-bottle"></div>
                                <div class="live-bottle"></div>
                            </div>
                        </div>
                    </div>
                    <p class="live-water-note">Visualized as single-liter water bottles.</p>
                </div>
                
            </article>
        </div>

        <p class="live-water-footnote">
            Based on global textile industry estimates (‚âà93 billion cubic meters annually).
            This counter converts that to liters per second and multiplies by the time since
            January 1st. It illustrates scale rather than providing an exact real-time reading.
        </p>
    </div>
</section>

<!-- INFO CARDS -->
<section class="section">
    <div class="section-inner">
        <h2 class="section-heading">What you will find here</h2>

        <div class="card-grid three">
            <div class="info-card">
                <h3>Key statistics</h3>
                <p>
                    A small set of headline numbers showing water use, emissions, and textile waste
                    by common fashion materials.
                </p>
            </div>

            <div class="info-card">
                <h3>Two clear visuals</h3>
                <p>
                    Simple charts comparing fibers and showing how waste and production changed
                    over time.
                </p>
            </div>

            <div class="info-card">
                <h3>Practical solutions</h3>
                <p>
                    Realistic, affordable actions for students and communities, plus a fairness
                    and ethics note.
                </p>
            </div>
        </div>
    </div>
</section>

<!-- PERSONAL IMPACT CALCULATOR -->
<section id="calculator" class="section section-calculator section-anchor-offset">
    <div class="section-inner">
        <h2 class="section-heading">Calculate Your Impact</h2>
        <p class="section-text">
            See how your clothing choices add up. Enter your annual purchases to discover your personal 
            water footprint, carbon emissions, and waste contribution.
        </p>
        
        <div class="calculator-container">
            <div class="calculator-inputs">
                <div class="calc-input-group">
                    <label for="items-per-year">How many clothing items do you buy per year?</label>
                    <input type="number" id="items-per-year" min="0" max="500" value="20" step="1">
                    <span class="calc-hint">Average: 20-30 items per year</span>
                </div>
                
                <div class="calc-input-group">
                    <label for="material-type">Primary material type</label>
                    <select id="material-type">
                        <option value="cotton">Cotton</option>
                        <option value="polyester">Polyester</option>
                        <option value="viscose">Viscose</option>
                        <option value="mixed">Mixed (average)</option>
                    </select>
                </div>
                
                <button id="calculate-btn" class="btn-calculate">Calculate My Impact</button>
            </div>
            
            <div id="calculator-results" class="calculator-results" style="display: none;">
                <h3 class="results-title">Your Annual Impact</h3>
                
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-icon">üíß</div>
                        <div class="result-value" id="water-result">0</div>
                        <div class="result-label">Liters of water</div>
                        <div class="result-comparison" id="water-comparison"></div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-icon">üåç</div>
                        <div class="result-value" id="co2-result">0</div>
                        <div class="result-label">kg CO‚ÇÇ emissions</div>
                        <div class="result-comparison" id="co2-comparison"></div>
                    </div>
                    
                    <div class="result-card">
                        <div class="result-icon">üóëÔ∏è</div>
                        <div class="result-value" id="waste-result">0</div>
                        <div class="result-label">kg textile waste</div>
                        <div class="result-comparison" id="waste-comparison"></div>
                    </div>
                </div>
                
                <div class="results-tip">
                    <p><strong>üí° Tip:</strong> Extending the life of your clothes by just 9 months can reduce your environmental impact by 20-30%.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- PROBLEM SECTION -->
<section id="problem" class="section section-problem section-anchor-offset">
    <div class="section-inner">
        <h2 class="section-heading">The Problem</h2>
        <section class="section">       
                <p class="section-text">
                    Fast fashion depends on low-cost fibers that require large amounts of water, energy,
                    and chemicals. Below you'll find headline statistics drawn from public reports, plus
                    charts that put the scale of the problem into context.
                </p>
            </div>
        </section>
        
        <section id="headline" class="section alt">
            <div class="section-inner">
                <h2 class="subheading">Headline numbers</h2>
                <p class="section-text">
                    These values are rounded estimates. They are meant to show scale, not exact predictions
                    for every brand or garment.
                </p>
        
                <div class="stats-grid">
                    {% for stat in stats %}
                    <article class="stat-card">
                        <p class="stat-title">{{ stat.title }}</p>
                        <p class="stat-value">{{ stat.value }} {{ stat.unit }}</p>
                        <p class="stat-desc">{{ stat.description }}</p>
                        {% if stat.source %}
                            <p class="stat-source">Source: {{ stat.source }}</p>
                        {% endif %}
                    </article>
                    {% empty %}
                    <p>No stats added yet. Use the admin site to create a few headline values.</p>
                    {% endfor %}
                </div>
            </div>
        </section>
        
                </div> <!-- end of .stats-grid -->
        
                <p class="section-text" style="margin-top: 10px;">
                    <strong>Note:</strong> These numbers come from public reports and industry analyses.
                    They show approximate scale, not exact predictions for every brand or garment.
                    Water use, emissions, and waste vary by region, production method, and year.
                </p>
        
            </div> <!-- end of .section-inner -->
        </section>
        
        </div> <!-- end of .section-inner -->
        </section>
        
        <section class="section">
            <div class="section-inner">
                <h2 class="subheading">Why fast fashion uses so much water</h2>
                <p class="section-text">
                    Cotton farming is one of the most water-intensive agricultural systems in the world, 
                    especially in dry regions where irrigation is required. On top of farming, dyeing, 
                    bleaching, and finishing fabrics use millions of liters of water each day. As fashion 
                    production accelerated in the 2000s, water use rose dramatically to keep up with demand.
                </p>
            </div>
        </section>
        
        <section class="section">
            <div class="section-inner">
                <h2 class="subheading">Explosion of synthetic fibers</h2>
                <p class="section-text">
                    Today, around 69% of all global fiber production is synthetic ‚Äî mainly polyester made 
                    from fossil fuels. These fibers are cheap, versatile, and perfectly suited for fast 
                    fashion‚Äôs rapid turnover model. However, synthetic production carries significant 
                    environmental costs, including high energy use, carbon emissions, and long-lasting waste.
                </p>
            </div>
        </section>
        
        <section class="section">
            <div class="section-inner">
                <h2 class="subheading">Overproduction and short clothing lifespans</h2>
                <p class="section-text">
                    The fashion industry now produces more than 100 billion garments annually ‚Äî more than 
                    enough for every person on Earth to buy 12‚Äì14 items every year. Many of these pieces 
                    are worn only a handful of times. About 60% of clothing is discarded within one year, 
                    contributing to massive resource waste and landfill buildup.
                </p>
            </div>
        </section>
        
        <section class="section">
            <div class="section-inner">
                <h2 class="subheading">What happens to clothes after we throw them away?</h2>
                <p class="section-text">
                    Around 87% of discarded textiles end up in landfills or incinerators. Only a small 
                    portion is recycled, and most of that is downcycled into lower-quality materials like 
                    insulation or industrial rags. Synthetic clothes can take decades to centuries to break 
                    down, releasing microplastics and chemicals as they degrade.
                </p>
            </div>
        </section>
        
        <section class="section">
            <div class="section-inner">
                <h2 class="subheading">Microplastics from polyester</h2>
                <p class="section-text">
                    Each load of laundry releases hundreds of thousands of tiny synthetic fibers into 
                    waterways. These microplastics have been found in oceans, soil, food, drinking water, 
                    and even human blood. Because polyester dominates the fast fashion market, microfiber 
                    pollution is growing quickly and has become one of the biggest environmental concerns 
                    connected to clothing.
                </p>
            </div>
        </section>
        
        <section class="section alt">
            <div class="section-inner">
                <h2 class="subheading">Fashion before vs. after the fast fashion boom</h2>
                <div class="card-grid three">
                    <article class="info-card">
                        <h3>Before (1990s)</h3>
                        <p>Seasonal collections</p>
                        <p>Higher-quality materials</p>
                        <p>More natural fibers</p>
                        <p>Less waste</p>
                    </article>
        
                    <article class="info-card">
                        <h3>Today</h3>
                        <p>Ultra-fast production cycles</p>
                        <p>More synthetic fibers</p>
                        <p>Lower durability</p>
                        <p>Rising water use and waste</p>
                    </article>
        
                    <article class="info-card">
                        <h3>The impact</h3>
                        <p>Increased landfill buildup</p>
                        <p>More microplastics released</p>
                        <p>Higher global emissions</p>
                        <p>Greater demand for resources</p>
                    </article>
                </div>
            </div>
        </section>
        
        
        
        <section class="section">
            <div class="section-inner">
                <h2 class="subheading">Visual 1: Material comparison</h2>
                <p class="section-text">
                    A simple chart comparing environmental impact by material (for example, liters of water
                    used per kilogram of fiber).
                </p>
                <img src="{% static 'impact/chart_materials.png' %}" class="chart-img"
                     alt="Chart comparing environmental impact by material">
            </div>
        </section>
        
        <section class="section alt">
            <div class="section-inner">
                <h2 class="subheading">Visual 2: Before vs. fast fashion era</h2>
                <p class="section-text">
                    A before/after view showing how textile waste or production has changed from an earlier
                    baseline to the fast fashion era.
                </p>
                <img src="{% static 'impact/chart_before_after.png' %}" class="chart-img"
                     alt="Before and after chart for textile waste or production">
            </div>
        </section>
    </div>
</section>

<!-- SOLUTIONS SECTION -->
<section id="solutions" class="section section-solutions section-anchor-offset">
    <div class="section-inner">
        <h2 class="section-heading">Solutions</h2>
        <section class="section">
                <p class="section-text">
                    Individuals aren‚Äôt responsible for fixing the fashion system‚Äîbut we can still take
                    actions that matter. Here are realistic steps, plus a brief fairness and ethics check
                    to keep things grounded.
                </p>
            </div>
        </section>
        
        <section class="section alt">
            <div class="section-inner">
                <h2 class="subheading">Fairness & Ethics</h2>
                <p class="section-text">
                    Sustainability often costs more. Not everyone can afford slow fashion, sustainable
                    brands, or specialty materials. Any ‚Äúsolution‚Äù must respect budgets, needs, and access.
                </p>
            </div>
        </section>
        
        <section class="section">
            <div class="section-inner">
                <h2 class="subheading">Realistic Actions</h2>
        
                <ul class="action-list">
                    <li>Buy fewer new items and wear the ones you have longer.</li>
                    <li>When affordable, try second-hand or clothing swaps.</li>
                    <li>Repair small rips or missing buttons instead of replacing clothes.</li>
                    <li>Donate or recycle textiles locally when possible.</li>
                    <li>Talk with friends about habits and sustainable options.</li>
                </ul>
            </div>
        </section>
    </div>
</section>

<!-- SOURCES / REFERENCES SECTION -->
<section id="sources" class="section section-sources section-anchor-offset">
    <div class="section-inner">
        <h2 class="section-heading">Sources</h2>
        <section class="section">
        
                <p class="section-text">
                    These are the reports, articles, and datasets used to create the headline numbers
                    and visuals on this site.
                </p>
        
                <ul class="source-list">
                    <li>Replace with your real sources from your research.</li>
                    <li>UN reports, Ellen MacArthur Foundation, WRAP, etc.</li>
                    <li>Articles on water use, CO‚ÇÇ emissions, textile waste.</li>
                    <li>Datasets on global production and disposal trends.</li>
                </ul>
            </div>
        </section>
    </div>
</section>
<script>
    function setYearProgress() {
        const now = new Date();
    
        // Start of this year (Jan 1, 00:00)
        const startOfYear = new Date(now.getFullYear(), 0, 1);
    
        // Start of next year (Jan 1 next year, 00:00)
        const startOfNextYear = new Date(now.getFullYear() + 1, 0, 1);
    
        const elapsedMs = now - startOfYear;
        const totalMs = startOfNextYear - startOfYear;
    
        let progress = (elapsedMs / totalMs) * 100;
    
        console.log("Year progress = ", progress);  // debug
    
        // Clamp to 0‚Äì100
        if (progress < 0) progress = 0;
        if (progress > 100) progress = 100;
    
        // Write into the CSS variable on :root (html element)
        document.documentElement.style.setProperty("--water-progress", progress);
    }
    
    // Run once when the page is ready
    document.addEventListener("DOMContentLoaded", setYearProgress);
    </script>

<script>
    // Personal Impact Calculator
    document.addEventListener("DOMContentLoaded", function() {
        const calculateBtn = document.getElementById("calculate-btn");
        const itemsInput = document.getElementById("items-per-year");
        const materialSelect = document.getElementById("material-type");
        const resultsDiv = document.getElementById("calculator-results");
        
        // Impact data per item (approximate averages in kg)
        const impactData = {
            cotton: {
                water: 10000,      // liters per kg (cotton is very water-intensive)
                co2: 15,           // kg CO2 per kg
                waste: 0.5         // kg waste per item (average)
            },
            polyester: {
                water: 2000,       // liters per kg (less water, but more energy)
                co2: 25,           // kg CO2 per kg (higher due to fossil fuels)
                waste: 0.5
            },
            viscose: {
                water: 6000,       // liters per kg
                co2: 12,           // kg CO2 per kg
                waste: 0.5
            },
            mixed: {
                water: 6000,       // average
                co2: 17,           // average
                waste: 0.5
            }
        };
        
        // Average weight per clothing item (kg)
        const avgItemWeight = 0.3; // 300g average per item
        
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + "M";
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + "k";
            }
            return Math.round(num).toLocaleString();
        }
        
        function animateValue(element, start, end, duration, formatFunc) {
            const startTime = performance.now();
            const isDecimal = end % 1 !== 0;
            
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Easing function for smooth animation
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                const current = start + (end - start) * easeOutQuart;
                
                if (isDecimal || end < 1000) {
                    element.textContent = formatFunc(current);
                } else {
                    element.textContent = formatFunc(Math.round(current));
                }
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                } else {
                    // Ensure final value is exact
                    element.textContent = formatFunc(end);
                }
            }
            
            requestAnimationFrame(update);
        }
        
        function calculateImpact() {
            const items = parseInt(itemsInput.value) || 0;
            const material = materialSelect.value;
            const data = impactData[material];
            
            if (items <= 0) {
                alert("Please enter a valid number of items.");
                return;
            }
            
            // Calculate impacts
            const totalWeight = items * avgItemWeight;
            const waterLiters = totalWeight * data.water;
            const co2Kg = totalWeight * data.co2;
            const wasteKg = items * data.waste;
            
            // Show results first
            resultsDiv.style.display = "block";
            resultsDiv.scrollIntoView({ behavior: "smooth", block: "nearest" });
            
            // Reset to 0 first
            document.getElementById("water-result").textContent = "0";
            document.getElementById("co2-result").textContent = "0";
            document.getElementById("waste-result").textContent = "0";
            
            // Animate values counting up
            const animationDuration = 2000; // 2 seconds
            
            animateValue(
                document.getElementById("water-result"),
                0,
                waterLiters,
                animationDuration,
                formatNumber
            );
            
            animateValue(
                document.getElementById("co2-result"),
                0,
                co2Kg,
                animationDuration,
                formatNumber
            );
            
            animateValue(
                document.getElementById("waste-result"),
                0,
                wasteKg,
                animationDuration,
                formatNumber
            );
            
            // Add comparisons (these can appear immediately or with slight delay)
            setTimeout(() => {
                const bathtubs = Math.round(waterLiters / 150);
                document.getElementById("water-comparison").textContent = 
                    `‚âà ${bathtubs} bathtubs of water`;
                
                const carMiles = Math.round(co2Kg / 0.4); // ~0.4 kg CO2 per mile
                document.getElementById("co2-comparison").textContent = 
                    `‚âà ${carMiles} miles driven`;
                
                const trashBags = Math.round(wasteKg / 2); // ~2 kg per trash bag
                document.getElementById("waste-comparison").textContent = 
                    `‚âà ${trashBags} trash bags`;
            }, animationDuration);
        }
        
        calculateBtn.addEventListener("click", calculateImpact);
        
        // Allow Enter key to calculate
        itemsInput.addEventListener("keypress", function(e) {
            if (e.key === "Enter") {
                calculateImpact();
            }
        });
    });
</script>
    
{% endblock %}
