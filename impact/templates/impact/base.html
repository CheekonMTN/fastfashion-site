{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Fighting Fast Fashion{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Styles -->
    <link rel="stylesheet" href="{% static 'impact/styles.css' %}">
</head>
<body>

<header class="header">
    <div class="header-inner">
        <a href="{% url 'home' %}" class="logo-container">
            <div class="logo-circle">FFF</div>
            <div class="logo-text">Fighting Fast Fashion</div>
        </a>

        <nav class="nav">
            <a href="{% url 'home' %}">Home</a>
        </nav>

        <div class="header-actions">
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
                <span class="theme-icon sun-icon">‚òÄÔ∏è</span>
                <span class="theme-icon moon-icon">üåô</span>
            </button>
            <a href="#problem" class="nav-cta">View Data</a>
        </div>
    </div>
</header>

<main class="main">
    {% block content %}{% endblock %}
</main>

<footer class="footer">
    <div class="footer-inner">
        <p class="footer-title">Fighting Fast Fashion</p>
        <p class="footer-desc">
            A student project visualizing the environmental impact of fast fashion materials.
        </p>
        <p class="footer-small">
            Data is sourced from public reports and may not reflect differences between brands,
            regions, or newer innovations in textile production.
        </p>
    </div>
</footer>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const litersEl    = document.getElementById("waterYearLitersDisplay");
    const tubsEl      = document.getElementById("waterYearBathtubsDisplay");
    const bottlesEl   = document.getElementById("waterYearBottlesDisplay");

    if (!litersEl || !tubsEl || !bottlesEl) return;

    const LITERS_PER_SECOND        = 2.95e6;  // ‚âà 2.95 million liters/second
    const LITERS_PER_BATHTUB       = 150;
    const LITERS_PER_BILLION_BOTTLES = 1e9;

    const now       = new Date();
    const yearStart = new Date(now.getFullYear(), 0, 1);

    function update() {
        const current        = new Date();
        const elapsedSeconds = (current - yearStart) / 1000.0;

        const totalLiters         = Math.floor(elapsedSeconds * LITERS_PER_SECOND);
        const totalBathtubs       = Math.floor(totalLiters / LITERS_PER_BATHTUB);
        const totalBillionBottles = totalLiters / LITERS_PER_BILLION_BOTTLES;

        litersEl.textContent  = totalLiters.toLocaleString();
        tubsEl.textContent    = totalBathtubs.toLocaleString();
        bottlesEl.textContent = totalBillionBottles.toFixed(1);

        requestAnimationFrame(update);
    }

    update();
});
</script>

<script src="{% static 'impact/js/year-progress.js' %}"></script>

<script>
    // Dark Mode Toggle
    (function() {
        'use strict';
        
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;
        
        // Check for saved theme preference or default to light mode
        const currentTheme = localStorage.getItem('theme') || 'light';
        
        // Apply the saved theme
        if (currentTheme === 'dark') {
            html.setAttribute('data-theme', 'dark');
        } else {
            html.setAttribute('data-theme', 'light');
        }
        
        // Toggle theme on button click
        if (themeToggle) {
            themeToggle.addEventListener('click', function() {
                const currentTheme = html.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                html.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
            });
        }
        
        // Listen for system theme changes
        if (window.matchMedia) {
            const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
            
            // Only apply system preference if user hasn't manually set a preference
            if (!localStorage.getItem('theme')) {
                const handleChange = (e) => {
                    html.setAttribute('data-theme', e.matches ? 'dark' : 'light');
                };
                
                mediaQuery.addEventListener('change', handleChange);
                handleChange(mediaQuery);
            }
        }
    })();
</script>

</body>
</html>
